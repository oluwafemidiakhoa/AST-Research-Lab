model:
  name: resnet18

dataset:
  num_classes: 10
  image_size: 224
  train_dir: "/path/to/cifar10/train"
  val_dir: "/path/to/cifar10/val"
  type: folder

ast:
  target_activation: 0.5
  initial_threshold: 0.8
  kp: 0.08
  ki: 0.01
  kp_warmup_epochs: 3
  ki_warmup_epochs: 6
  entropy_weight: 0.8
  min_active: 4

training:
  epochs: 1
  batch_size: 128
  lr: 0.1
  momentum: 0.9
  weight_decay: 0.0005
  num_workers: 4
  mixed_precision: true
  grad_accum_steps: 1
  max_minutes: 120
  early_stop_patience: 5

logging:
  output_dir: "results_test"
  jsonl_path: "results_test/train_log_cifar10.jsonl"

metrics:
  base_flop_per_sample: 1.7e9   # ResNet-18 fwd+bwd ~1.7 GFLOPs/sample
  gpu_tdp_watts: 180
